<html>

<head>
  <script src="https://unpkg.com/vue@next"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-database-compat.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js"
    crossorigin="anonymous"></script>
  <link href="bootstrap/css/styles.css" rel="stylesheet" />
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  <script src="bootstrap/js/datatables-simple-demo.js"></script>
  <script src="bootstrap/js/scripts.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"></script>
  <script src="bootstrap/js/scripts.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js"
    crossorigin="anonymous"></script>

</head>

<body>

  <div id="app" class="container">
    <div>
      <h1 class="px-2">Blood Pressure</h1>
      <label>Systolic BP: </label>
      <input type="text" v-model="sysBP">
      <label>Diastolic BP: </dabel>
      <input type="text" v-model="diaBP">
      <label >Date:</label>
      <input type="date" v-model = "date" >
      <button @click="saveUser()">Save</button>
      <button @click="getUsers()">Get Users</button>
    </div>
  <!-- </div>  -->

    <div>
      <table v-if="canViewTable" class="table">
        <thead>
          <th>Systolic BP</th>
          <th>Diastolic BP</th>
          <th>date</th>
        </thead>
        <tbody>
          <tr v-for="(user, index) in users" :key="index">
            <th scope="col">{{ user.sysBP }}</th>
            <th scope="col">{{ user.diaBP }}</th>
            <th scope="col">{{ user.date }}</th>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div>
      <div class="card mb-4" v-if="canViewTable">
        <div class="card-header">
          <i class="fas fa-table me-1"></i>
          DataTable Example
        </div>
        <div class="card-body">
          <table id="datatablesSimple">
            <thead>
              <tr>
                <th>Systolic BP</th>
                <th>Diastolic BP</th>
                <th>Date</th>
              </tr>
            </thead>
            <tfoot>
              <tr>
                <th>Systolic BP</th>
                <th>Diastolic BP</th>
                <th>Date</th>
            </tfoot>
            <tbody>
              <tr v-for="(user, index) in users" :key="index">
                <td>{{ user.sysBP }}</td>
                <td>{{ user.diaBP}}</td>
                <td>{{ user.date}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    

  </div>
</body>

</html>

<script type="module">
  const firebaseConfig = {
    databaseURL: "https://wad2-project-577ea-default-rtdb.asia-southeast1.firebasedatabase.app",
    apiKey: "AIzaSyDWR7cQApDtFlD2wx5Btku67Bhg8_xwsUg",
    authDomain: "wad2-project-577ea.firebaseapp.com",
    projectId: "wad2-project-577ea",
    storageBucket: "wad2-project-577ea.appspot.com",
    messagingSenderId: "878918082978",
    appId: "1:878918082978:web:250e7cfd55234ea00012fb",
    measurementId: "G-SLGD98DFQ5"
  };

  // Initialize Firebase 
  firebase.initializeApp(firebaseConfig);
  var database = firebase.database();
  const vue = Vue.createApp({
    data() {
      return {
        sysBP: "",
        diaBP: "",
        date: "",
        users: [],
        canViewTable: false,
      }
    },
    methods: {
      saveUser() {
        var userRef = database.ref('users');
        var newUserRef = userRef.push();
        newUserRef.set({
          sysBP: this.sysBP,
          diaBP: this.diaBP,
          date: this.date,
         
        });
      },
      getUsers() {
        var userRef = firebase.database().ref('users');
        userRef.on('value', (snapshot) => {
          const data = snapshot.val();
          this.users = data;
          console.log("Data: ", data);
          this.canViewTable = true;
        });
      }
    }
  })
  const vm = vue.mount("#app")

</script>